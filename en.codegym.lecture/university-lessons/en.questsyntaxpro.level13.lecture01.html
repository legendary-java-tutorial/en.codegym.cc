for-each loop
<p>----------------------------------------</p>
Background on how iterators came to be. You are already familiar with HashSet. If you've really investigated it, beyond just reading a lesson, then you should have asked this question: How do I display a list of all HashSet elements on the screen? After all, the interface does not have get() and set() methods! And HashSet is not alone...
<p>----------------------------------------</p>
<h2>1. Background on how iterators came to be</h2>
<p>You are already familiar with <code>HashSet</code>. If you've really investigated it, beyond just reading a lesson, then you should have asked this question:</p>
<p><strong>How do I display a list of all HashSet elements on the screen?</strong> After all, the interface does not have <code>get()</code> and <code>set()</code> methods!</p>
<p>And <code>HashSet</code> is not alone in this limitation. In addition to <code>HashSet</code>, there are many other collections that do not allow elements to be retrieved by index, because the elements have no defined order.</p>
<p>Over the years, programmers have invented lots of complex data structures, such as graphs and trees. Or lists of lists.</p>
<p>Many containers change the order of their elements when new elements are added or existing elements are removed. For example, a list stores elements in a particular order, and when a new element is added, it is almost always inserted in the middle of the list.</p>
<p>And we also get situations where there is a container that stores elements but not in any fixed order.</p>
<p>Now let's say we want to copy all the elements from such a collection into an array or list. We need to get all the elements. We don't care about the order in which we iterate over the elements — the important thing is not to iterate over the same elements more than once. How do we do that?</p>
<hr>
<h2>2. Iterator for a collection</h2>
<p><span class="term">Iterators</span> were proposed as a solution to the problem above.</p>
<p>An iterator is a special object associated with a collection, which helps traverse all the elements of the collection without repeating any.</p>
<p>You can use the following code to get an iterator for any collection:</p>
<div class="lesson-example lesson-example--center">
    <pre class="lecture-code lecture-code--present language-java"><code><span class="text-neon">Iterator</span>&lt;<span class="text-viola">Type</span>&gt; <span class="text-orange">it</span> = <span class="text-green">name</span>.<span class="text-user">iterator</span>();</code></pre>
</div>
<p>Where <code><span class="text-green">name</span></code> is the name of collection variable, <code><span class="text-viola">Type</span></code> is the type of the elements of the collection, <code><span class="text-user">iterator</span>()</code> is one of the collection's methods, and <code><span class="text-orange">it</span></code> is the name of the iterator variable.</p>
<p>An iterator object has 3 methods:</p>
<table>
    <tbody>
    <tr>
        <th>Method</th>
        <th>Description</th>
    </tr>
    <tr>
        <td>
            <pre class="language-java"><code><span class="text-viola">Type</span> <span class="text-red">next</span>()</code></pre>
        </td>
        <td>Returns the next element in the collection</td>
    </tr>
    <tr>
        <td>
            <pre class="language-java"><code>boolean <span class="text-red">hasNext</span>()</code></pre>
        </td>
        <td>Checks whether there are any elements that have not been traversed yet</td>
    </tr>
    <tr>
        <td>
            <pre class="language-java"><code>void <span class="text-red">remove</span>()</code></pre>
        </td>
        <td>Removes the current element of the collection</td>
    </tr>
    </tbody>
</table>
<p>These methods are somewhat similar to the Scanner class's <code>nextInt)</code> and <code>hasNextInt()</code> methods.</p>
<p>The <code><span class="text-red">next</span>()</code> method returns the next element of the collection from which we got the iterator.</p>
<p>The <code><span class="text-red">hasNext</span>()</code> method checks whether the collection has additional elements that the iterator has not returned yet.</p>
<p>Here's how to display all the elements of a <code>HashSet</code>:</p>
<table>
    <tbody>
    <tr>
        <th>Code</th>
        <th>Notes</th>
    </tr>
    <tr>
        <td>
<pre class="language-java"><code><span class="text-neon">HashSet</span>&lt;<span class="text-viola">String</span>&gt; <span class="code text-user">set</span> = new <span class="text-neon">HashSet</span>&lt;<span class="text-viola">String</span>&gt;();

<span class="code text-user">set</span>.<span class="text-red">add</span>("Hallo");
<span class="code text-user">set</span>.<span class="text-red">add</span>("Hello");
<span class="code text-user">set</span>.<span class="text-red">add</span>("Hola");
<span class="code text-user">set</span>.<span class="text-red">add</span>("Bonjour");
<span class="code text-user">set</span>.<span class="text-red">add</span>("Ciao");
<span class="code text-user">set</span>.<span class="text-red">add</span>("Namaste");

Iterator&lt;String&gt; <span class="code text-orange">it</span> = <span class="code text-user">set</span>.<span class="text-red">iterator</span>();
while (<span class="code text-orange">it</span>.<span class="text-red">hasNext</span>())
{
   <span class="text-viola">String</span> str = <span class="code text-orange">it</span>.<span class="text-red">next</span>();
   System.out.println(<span class="code text-green">str</span>);
}</code></pre>
        </td>
        <td>Create a <code>HashSet</code> object that stores <code>String</code> elements.<br><br><br>
            We add greetings in various languages to the <code>set</code> variable.<br><br><br><br><br>
            Get an iterator object for the <code>set</code> set.<br>
            As long as there are still elements<br><br>
            Get the next element<br>
            Display the element on the screen
        </td>
    </tr>
    </tbody>
</table>
<hr>
<div class="task-widget-container" showCover="true" taskKey="en.codegym.task.pro.task13.task1303"></div>
<hr>
<h2>3. <code>For-each</code> loop</h2>
<p>The main disadvantage of an iterator is that your code becomes more cumbersome than using a <code>for</code> loop.</p>
<p>To compare, let's display a list using a <code>for</code> loop and also using an iterator:</p>
<table>
    <tbody>
    <tr>
        <th>Iterator</th>
        <th>for loop</th>
    </tr>
    <tr>
        <td>
<pre class="language-java"><code><span class="text-neon">ArrayList</span>&lt;<span class="text-viola">String</span>&gt; <span class="code text-user">list</span> = new <span class="text-neon">ArrayList</span>&lt;<span class="text-viola">String</span>&gt;();

Iterator&lt;<span class="text-viola">String</span>&gt; <span class="code text-orange">it</span> = <span class="code text-user">list</span>.<span class="text-red">iterator</span>();
while (<span class="code text-orange">it</span>.<span class="text-red">hasNext</span>())
{
<span class="text-viola">   String</span> <span class="code text-green">str</span> = it.next();
   System.out.println(<span class="code text-green">str</span>);
}</code></pre>
        </td>
        <td>
<pre class="language-java"><code><span class="text-neon">ArrayList</span>&lt;<span class="text-viola">String</span>&gt; <span class="code text-user">list</span> = new <span class="text-neon">ArrayList</span>&lt;<span class="text-viola">String</span>&gt;();

for (int i = 0; i &lt; <span class="code text-user">list</span>.<span class="text-red">size</span>(); i++)
{
   String <span class="code text-green">str</span> = <span class="code text-user">list</span>.<span class="text-red">get</span>(i);
   System.out.println(<span class="code text-green">str</span>);
}</code></pre>
        </td>
    </tr>
    </tbody>
</table>
<p>Yes, it's much better to traverse the elements of an <code>ArrayList</code> using a loop — everything turns out to be shorter.</p>
<p>But Java's creators again decided to pour some sugar on us. Luckily for us, it was <span class="term">syntactic sugar</span>.</p>
<p>They gave Java a new kind of loop and called it a <code>for-each</code> loop. This is how it looks in general:</p>
<div class="lesson-example lesson-example--center">
    <pre class="lecture-code lecture-code--present language-java"><code>for(<span class="text-viola">Type</span> <span class="text-green">name</span>:<span class="text-user">collection</span>)</code></pre>
</div>
<p>Where <code><span class="text-user">collection</span></code> is the name of the collection variable, <code><span class="text-viola">Type</span></code> is the type of the elements in the collection, and <code><span class="text-green">name</span></code> is the name of a variable that takes the next value from the collection at each iteration of the loop.</p>
<p>This kind of loop iterates through all the elements of a collection using an implicit iterator. This is how it actually works:</p>
<table>
    <tbody>
    <tr>
        <th>For-each loop</th>
        <th>What the compiler sees: Loop with an iterator</th>
    </tr>
    <tr>
        <td>
<pre class="language-java"><code><span class="text-neon">ArrayList</span>&lt;<span class="text-viola">String</span>&gt; <span class="code text-user">list</span> = new <span class="text-neon">ArrayList</span>&lt;<span class="text-viola">String</span>&gt;();

for (<span class="text-viola">String</span> <span class="code text-green">str</span>: <span class="code text-user">list</span>)
{
   System.out.println(<span class="code text-green">str</span>);
}</code></pre>
        </td>
        <td>
<pre class="language-java"><code><span class="text-neon">ArrayList</span>&lt;<span class="text-viola">String</span>&gt; <span class="code text-user">list</span> = new <span class="text-neon">ArrayList</span>&lt;<span class="text-viola">String</span>&gt;();
Iterator&lt;<span class="text-viola">String</span>&gt; <span class="code text-orange">it</span> = <span class="code text-user">list</span>.<span class="text-red">iterator</span>();

while (<span class="code text-orange">it</span>.<span class="text-red">hasNext</span>())
{
   <span class="text-viola">String</span> <span class="code text-green">str</span> = <span class="code text-orange">it</span>.<span class="text-orange">next</span>();
   System.out.println(<span class="code text-green">str</span>);
}</code></pre>
        </td>
    </tr>
    </tbody>
</table>
<p>When the compiler encounters a <code>for-each</code> loop in your code, it simply replaces it with the code on the right: it adds a call to get an iterator along with any other missing method calls.</p>
<p>Programmers love the <code>for-each</code> loop and almost always use it when they need to iterate over all of the elements of a collection.</p>
<p>Even iterating over an <code>ArrayList</code> list using a <code>for-each</code> loop looks shorter:</p>
<table>
    <tbody>
    <tr>
        <th>For-each loop</th>
        <th>for loop</th>
    </tr>
    <tr>
        <td>
<pre class="language-java"><code><span class="text-neon">ArrayList</span>&lt;<span class="text-viola">String</span>&gt; <span class="code text-user">list</span> = new <span class="text-neon">ArrayList</span>&lt;<span class="text-viola">String</span>&gt;();

for (<span class="text-viola">String</span> <span class="code text-green">str</span>: <span class="code text-user">list</span>)
{
   System.out.println(<span class="code text-green">str</span>);
}</code></pre>
        </td>
        <td>
<pre class="language-java"><code><span class="text-neon">ArrayList</span>&lt;<span class="text-viola">String</span>&gt; <span class="code text-user">list</span> = new <span class="text-neon">ArrayList</span>&lt;<span class="text-viola">String</span>&gt;();

for (int i = 0; i &lt; <span class="code text-user">list</span>.<span class="text-red">size</span>(); i++)
{
   String <span class="code text-green">str</span> = <span class="code text-user">list</span>.<span class="text-red">get</span>(i);
   System.out.println(<span class="code text-green">str</span>);
}</code></pre>
        </td>
    </tr>
    </tbody>
</table>
<hr>
<div class="task-widget-container" showCover="true" taskKey="en.codegym.task.pro.task13.task1304"></div>
<hr>
<h2>4. Removing an element in a <code>for-each</code> loop</h2>
<p>The <code>for-each</code> loop has one drawback: it can't remove elements correctly. If you write code like this, you'll get an error.</p>
<table>
    <tbody>
    <tr>
        <th>Code</th>
        <th>Note</th>
    </tr>
    <tr>
        <td>
<pre class="language-java"><code><span class="text-neon">ArrayList</span>&lt;<span class="text-viola">String</span>&gt; <span class="code text-user">list</span> = new <span class="text-neon">ArrayList</span>&lt;<span class="text-viola">String</span>&gt;();

<span class="code text-user">list</span>.<span class="text-red">add</span>("Hallo");
<span class="code text-user">list</span>.<span class="text-red">add</span>("Hello");
<span class="code text-user">list</span>.<span class="text-red">add</span>("Hola");
<span class="code text-user">list</span>.<span class="text-red">add</span>("Bonjour");
<span class="code text-user">list</span>.<span class="text-red">add</span>("Ciao");
<span class="code text-user">list</span>.<span class="text-red">add</span>("Namaste");

for (<span class="text-viola">String</span> <span class="code text-green">str</span>: <span class="code text-user">list</span>)
{
   if (<span class="code text-green">str</span>.equals("Hello"))
      <span class="code text-user">list</span>.<span class="text-red">remove</span>(<span class="code text-green">str</span>);
}</code></pre>
        </td>
        <td><br><br><br><br><br><br><br><br><br><br><br><br><span class="text-red">The remove operation will generate an error!</span></td>
    </tr>
    </tbody>
</table>
<p>This is a very nice and understandable code, but it won't work.</p>
<div class="lesson-note lesson-note--important">
    <div class="lesson-note__container">
        <div class="lesson-note__head">Important!</div>
        <div class="lesson-note__content">
            <p>You can't change a collection while you are traversing it with an iterator.</p>
        </div>
    </div>
</div>
<p>There are three ways to get around this limitation.</p>
<p><strong>1. Use a different kind of loop</strong></p>
<p><code>When traversing an ArrayList collection</code>, you can use an ordinary loop with an <code>i</code> counter variable.</p>
<table>
    <tbody>
    <tr>
        <th>Code</th>
    </tr>
    <tr>
        <td>
<pre class="language-java"><code>for (int i = 0; i &lt; <span class="code text-user">list</span>.size(); i++)
{
   String <span class="code text-green">str</span> = <span class="code text-user">list</span>.get(i);

   if (<span class="code text-green">str</span>.equals("Hello"))
   {
      <span class="code text-user">list</span>.<span class="text-red">remove</span>(str);
      i--; // We need to decrease i, because the remove operation shifted the elements
   }
}</code></pre>
        </td>
    </tr>
    </tbody>
</table>
<p>However, this option is not suitable for <code>HashSet</code> and <code>HashMap</code> collections</p>
<p><strong>2. Use an explicit iterator</strong></p>
<p>You can use an iterator explicitly and call its <code>remove()</code> method.</p>
<table>
    <tbody>
    <tr>
        <th>Version that works</th>
        <th><span class="text-red">Version that doesn't work</span></th>
    </tr>
    <tr>
        <td>
<pre class="language-java"><code>Iterator&lt;<span class="text-viola">String</span>&gt; <span class="code text-orange">it</span> = set.iterator();
while (<span class="code text-orange">it</span>.<span class="text-red">hasNext</span>())
{
   String <span class="code text-green">str</span> = <span class="code text-orange">it</span>.<span class="text-red">next</span>();
   if (<span class="code text-green">str</span>.equals("Hello"))
       <span class="code text-orange">it</span>.<span class="text-red">remove</span>();
}</code></pre>
        </td>
        <td>
<pre class="language-java"><code><br>for (<span class="text-viola">String</span> <span class="code text-green">str</span>: <span class="code text-user">list</span>)
{
   if (<span class="code text-green">str</span>.equals("Hello"))
      <span class="code text-user">list</span>.<span class="text-red">remove</span>(<span class="code text-green">str</span>);
}</code></pre>
        </td>
    </tr>
    </tbody>
</table>
<p>Note that we call the <code>remove()</code> method on the iterator object! The iterator is aware that the item has been removed and can handle the situation correctly.</p>
<p><strong>3. Use a copy of the collection</strong></p>
<p>You can also create a copy of the collection and then use the copy in a <code>for-each</code> loop and delete elements from the original collection.</p>
<table>
    <tbody>
    <tr>
        <th>Code</th>
        <th>Note</th>
    </tr>
    <tr>
        <td>
<pre class="language-java"><code><span class="text-neon">ArrayList</span>&lt;<span class="text-viola">String</span>&gt; <span class="code text-user">listCopy</span> = new <span class="text-neon">ArrayList</span>(<span class="code text-user">list</span>);

for (<span class="text-viola">String</span> <span class="code text-green">str</span>: <span class="code text-user">listCopy</span>)
{
   if (<span class="code text-green">str</span>.equals("Hello"))
      <span class="code text-user">list</span>.<span class="text-red">remove</span>(<span class="code text-green">str</span>);
}</code></pre>
        </td>
        <td>Creating a copy of a collection is super easy<br><br><br><br>
            The loop uses the iterator for the copy of the collection.<br>
            Elements are removed from the <code>list</code> collection.
        </td>
    </tr>
    </tbody>
</table>
<p>The collection is copied rather quickly, since the elements themselves are not duplicated. Instead, the new collection stores references to the elements that already exist in the old collection.</p>
<div class="task-widget-container" showCover="true" taskKey="en.codegym.task.pro.task13.task1305"></div>